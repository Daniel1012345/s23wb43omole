"use strict";var createError=require("http-errors"),express=require("express"),path=require("path"),cookieParser=require("cookie-parser"),logger=require("morgan");require("dotenv").config();var connectionString=process.env.MONGO_CON;mongoose=require("mongoose"),mongoose.connect(connectionString,{useNewUrlParser:!0,useUnifiedTopology:!0});var indexRouter=require("./routes/index"),usersRouter=require("./routes/users"),musicalsRouter=require("./routes/musical"),boardRouter=require("./routes/board"),gridbuildRouter=require("./routes/gridbuild"),selectorRouter=require("./routes/selector"),Musicals=require("./models/musical"),resourceRouter=require("./routes/resource"),app=express(),db=mongoose.connection;function recreateDB(){var r,o,s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(Musicals.deleteMany());case 2:r=new Musicals({instrument_type:"Guiter",brand:"Yamaha",cost:25.4}),o=new Musicals({instrument_type:"Piano",brand:"Yamaha",cost:250.4}),s=new Musicals({instrument_type:"Talking drum",brand:"Sony",cost:200.4}),r.save().then(function(e){console.log("First object saved")}).catch(function(e){console.error(e)}),o.save().then(function(e){console.log("Second object saved")}).catch(function(e){console.error(e)}),s.save().then(function(e){console.log("Third object saved")}).catch(function(e){console.error(e)});case 8:case"end":return e.stop()}})}db.on("error",console.error.bind(console,"MongoDB connection error:")),db.once("open",function(){console.log("Connection to DB succeeded")}),app.set("views",path.join(__dirname,"views")),app.set("view engine","pug"),app.use(logger("dev")),app.use(express.json()),app.use(express.urlencoded({extended:!1})),app.use(cookieParser()),app.use(express.static(path.join(__dirname,"public"))),app.use("/resource",resourceRouter),app.use("/",indexRouter),app.use("/users",usersRouter),app.use("/musical",musicalsRouter),app.use("/board",boardRouter),app.use("/gridbuild",gridbuildRouter),app.use("/selector",selectorRouter),app.use(function(e,r,o){o(createError(404))}),app.use(function(e,r,o,s){o.locals.message=e.message,o.locals.error="development"===r.app.get("env")?e:{},o.status(e.status||500),o.render("error")});var reseed=!0;reseed&&recreateDB(),module.exports=app;
//# sourceMappingURL=app.min.js.map
